# 檔案功能說明

## 1. scripts/ 資料夾

包含所有資料處理和維護工具腳本：

### 核心腳本

#### 📝 `updateQuestionIndex.js` ⭐ **最重要**
- **功能**：掃描題目資料夾結構，自動生成索引檔案
- **產出**：
  - `assets/data/questions.json` - 題目索引檔案
  - `src/services/questionFileMap.ts` - 題目檔案映射表
- **使用時機**：新增、修改或刪除題目檔案後
- **執行方式**：`node scripts/updateQuestionIndex.js`

#### 🖼️ `updateImageFileMap.js`
- **功能**：掃描圖片資料夾，生成圖片映射表
- **產出**：`src/services/imageFileMap.ts`
- **使用時機**：新增或修改圖片後
- **執行方式**：`node scripts/updateImageFileMap.js`

### 資料轉換腳本

#### 📊 `convertExcelToJSON.js`
- **功能**：將 Excel 檔案轉換為 JSON 格式
- **支援格式**：
  - IPAS 格式：`IPAS_01初級_L11 人工智慧基礎概論_11409.xlsx`
  - 舊格式：`信託實務_61期.xlsx`
- **產出**：JSON 題目檔案
- **執行方式**：`node scripts/convertExcelToJSON.js`

#### 📄 `convertExcelToCSV.ts`
- **功能**：將 Excel 檔案轉換為 CSV 格式
- **用途**：資料備份或匯出

### 遷移腳本

#### 📁 `migrateToFolderStructure.js`
- **功能**：將舊格式的題目檔案遷移到新的三層資料夾結構
- **遷移規則**：
  - `IPAS_01_L11_11401.json` → `IPAS_01/L11/11401.json`
  - 簡化檔案格式，移除重複的 metadata
- **執行方式**：`node scripts/migrateToFolderStructure.js`

#### 🖼️ `migrateImagesToFolderStructure.js`
- **功能**：將舊格式的圖片資料夾遷移到新的三層結構
- **遷移規則**：
  - `IPAS_01_AI_11401/` → `IPAS_01/L11/11401/`
  - `IPAS_02_L23_11411/` → `IPAS_02/L23/11411/`
- **執行方式**：`node scripts/migrateImagesToFolderStructure.js`

### 驗證與修復腳本

#### ✅ `validateJson.js`
- **功能**：驗證所有 JSON 檔案的格式正確性
- **檢查項目**：
  - metadata 是否存在
  - questions 陣列是否存在
  - 每個題目是否包含必要欄位（id, content, A, B, C, D, Ans, exp）
- **執行方式**：`node scripts/validateJson.js`

#### 🔧 `fixEmptyExp.js`
- **功能**：修復空白的詳解欄位
- **處理**：將空的 `exp` 欄位填入預設值「此題目暫無詳細說明。」
- **執行方式**：`node scripts/fixEmptyExp.js`

### 統計與檢查腳本

#### 📊 `generateStats.js`
- **功能**：生成題目資料統計報告
- **顯示內容**：
  - 總題數、總檔案數
  - 測驗名稱統計
  - 科目統計
  - 期數統計
- **執行方式**：`node scripts/generateStats.js`

#### 🔍 `checkTestNames.js`
- **功能**：檢查所有檔案的 testName，分類統計
- **分類**：IPAS_AI、IPAS_01、IPAS_02
- **執行方式**：`node scripts/checkTestNames.js`

#### 📋 `listTestNames.js`
- **功能**：列出所有不重複的 testName
- **執行方式**：`node scripts/listTestNames.js`

### 其他工具

#### 🗑️ `clearCache.js`
- **功能**：清除快取資料
- **用途**：開發時清除舊資料

#### 🗺️ `generateQuestionFileMap.js` (舊版)
- **功能**：舊版的映射表生成腳本（已由 `updateQuestionIndex.js` 取代）
- **狀態**：已過時，保留供參考

---

## 2. README.md

### 功能
專案的主要說明文件，包含：

1. **功能特色說明**
   - 測驗名稱列表頁
   - 科目列表頁
   - 期數列表頁
   - 作答頁
   - 錯題本頁
   - 複習作答頁

2. **技術架構**
   - React Native + Expo
   - 資料儲存方式
   - 題目資料格式

3. **安裝與執行**
   - 前置需求
   - 安裝步驟
   - 執行方式（Web/iOS/Android）

4. **專案結構**
   - 資料夾組織
   - 檔案說明

5. **核心功能流程**
   - 作答流程
   - 複習流程

6. **資料結構**
   - Question 介面
   - UserAnswer 介面
   - Series 介面

### 用途
- 新開發者快速了解專案
- 功能說明與使用指南
- 開發環境設定參考

---

## 3. questions.json

### 功能
**題目索引檔案**，是整個系統的核心索引，包含：

### 結構說明

```json
{
  "metadata": {
    "version": "3.0.0",           // 資料版本號
    "lastUpdated": "2025-12-16...", // 最後更新時間
    "totalQuestions": 1088         // 總題數
  },
  "testNames": [                    // 測驗名稱列表
    {
      "id": "test-IPAS_01",
      "name": "IPAS_01",
      "totalQuestions": 899,
      "completedQuestions": 0,
      "completionPercentage": 0
    }
  ],
  "subjects": [                     // 科目列表
    {
      "id": "subject-IPAS_01-L11",
      "name": "L11",
      "testName": "IPAS_01",
      "totalQuestions": 648,
      ...
    }
  ],
  "series": [                       // 期數列表
    {
      "id": "series-IPAS_01-L11-11401",
      "name": "11401",
      "testName": "IPAS_01",
      "subject": "L11",
      "totalQuestions": 50,
      ...
    }
  ],
  "questionFiles": [                // 題目檔案清單
    {
      "testName": "IPAS_01",
      "subject": "L11",
      "series_no": "11401",
      "file": "questions/IPAS_01/L11/11401.json",
      "count": 50
    }
  ]
}
```

### 用途
1. **快速導航**：應用程式載入時讀取此檔案，建立測驗→科目→期數的導航結構
2. **進度追蹤**：記錄每個測驗、科目、期數的完成進度
3. **檔案映射**：記錄每個題目檔案的實際路徑
4. **統計資訊**：提供總題數、完成題數等統計

### 更新方式
- **自動更新**：執行 `node scripts/updateQuestionIndex.js`
- **手動更新**：不建議，容易出錯

### 版本資訊
- **當前版本**：3.0.0（支援新資料夾結構）
- **版本歷史**：
  - v2.0.0：舊格式（單一資料夾）
  - v3.0.0：新格式（三層資料夾結構）

---

## 4. questions.json.backup

### 功能
`questions.json` 的備份檔案

### 內容差異

| 項目 | questions.json | questions.json.backup |
|------|----------------|----------------------|
| **版本** | 3.0.0 | 2.0.0 |
| **總題數** | 1088 題 | 374 題 |
| **檔案格式** | 新格式（三層資料夾） | 舊格式（單一資料夾） |
| **檔案路徑** | `questions/IPAS_01/L11/11401.json` | `questions/IPAS_01_L11_11409.json` |
| **更新時間** | 2025-12-16 | 2025-12-13 |

### 用途
1. **版本對照**：比較新舊格式的差異
2. **資料恢復**：如果新格式有問題，可以參考備份檔案
3. **歷史記錄**：保留舊版本的資料結構

### 建議
- **保留**：作為歷史記錄和參考
- **不刪除**：除非確定不再需要舊格式參考

---

## 使用流程建議

### 新增題目時
1. 將 Excel 檔案放入 `data/` 資料夾
2. 執行 `node scripts/convertExcelToJSON.js` 轉換為 JSON
3. 將 JSON 檔案放入對應的資料夾：`assets/data/questions/{testName}/{subject}/`
4. 執行 `node scripts/updateQuestionIndex.js` 更新索引
5. 執行 `node scripts/validateJson.js` 驗證格式

### 新增圖片時
1. 將圖片放入對應資料夾：`assets/images/{testName}/{subject}/{series_no}/`
2. 執行 `node scripts/updateImageFileMap.js` 更新映射表

### 定期維護
1. 執行 `node scripts/generateStats.js` 查看統計
2. 執行 `node scripts/validateJson.js` 檢查資料完整性
3. 如有空白詳解，執行 `node scripts/fixEmptyExp.js` 修復

---

## 總結

| 項目 | 主要功能 | 更新頻率 | 重要性 |
|------|---------|---------|--------|
| **scripts/** | 資料處理工具 | 需要時執行 | ⭐⭐⭐⭐⭐ |
| **README.md** | 專案說明文件 | 功能變更時更新 | ⭐⭐⭐⭐ |
| **questions.json** | 題目索引（核心） | 每次新增題目後 | ⭐⭐⭐⭐⭐ |
| **questions.json.backup** | 備份檔案 | 不更新 | ⭐⭐ |

